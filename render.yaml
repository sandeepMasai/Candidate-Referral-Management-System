# Render Blueprint Configuration
# 
# IMPORTANT: Before using this file:
# 1. Update the repo URLs below with your actual GitHub repository URL
# 2. Set all sync: false environment variables in Render dashboard after deployment
# 3. Deploy backend first, then frontend (to get backend URL)
#
# To use this blueprint:
# 1. Commit this file to your repository
# 2. Go to Render Dashboard → Blueprint → New Blueprint
# 3. Connect your repository
# 4. Render will create services automatically
#
# Alternatively, create services manually using RENDER_DEPLOYMENT.md guide

services:
  # Backend API Service
  - type: web
    name: candidate-referral-api
    env: node
    region: oregon  # Change to your preferred region (oregon, frankfurt, singapore, etc.)
    plan: free  # Options: free, starter, standard, pro
    repo: https://github.com/sandeepMasai/Candidate-Referral-Management-System.git
    branch: main  # or your default branch
    rootDir: backend
    buildCommand: npm install
    startCommand: npm start
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: CLIENT_ORIGIN
        sync: false  # Set manually in Render dashboard after frontend is deployed
      - key: MONGODB_URI
        sync: false  # Set manually for security - never commit this!
      - key: MONGODB_DB_NAME
        value: candidate_referrals
      - key: MONGODB_AUTH_SOURCE
        value: candidate_referrals
      - key: JWT_SECRET
        sync: false  # Set manually - generate a strong secret (min 32 chars)
      - key: JWT_EXPIRES_IN
        value: 7d
      - key: RESET_TOKEN_EXPIRES_MINUTES
        value: 30
      - key: MAX_FILE_SIZE_MB
        value: 5
      - key: CLOUDINARY_CLOUD_NAME
        sync: false  # Set manually for security
      - key: CLOUDINARY_API_KEY
        sync: false  # Set manually for security
      - key: CLOUDINARY_API_SECRET
        sync: false  # Set manually for security

  # Frontend Static Site
  - type: web
    name: candidate-referral-frontend
    env: static
    region: oregon  # Match backend region for lower latency
    repo: https://github.com/sandeepMasai/Candidate-Referral-Management-System.git
    branch: main
    rootDir: frontend
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    envVars:
      - key: VITE_API_BASE_URL
        sync: false  # Set manually after backend is deployed (e.g., https://candidate-referral-api.onrender.com/api)
      - key: VITE_BACKEND_ORIGIN
        sync: false  # Set manually after backend is deployed (e.g., https://candidate-referral-api.onrender.com)

